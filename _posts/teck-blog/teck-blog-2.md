---
title: 【Webを支える技術】を読んだメモ
slug: teck-blog-2
tag: ['HTML', 'REST', 'Web', 'HTTP', 'URI']
image: study.png
created_at: 2021-12-02T23:11:36
description: 書籍「Webを支える技術」を読んだので個人的に覚えたかった用語や概念をメモしている記事
---
# RESTとは

RESTとはWebのアーキテクチャスタイルである。
俗に言うMVC(Model View Controller)等と同義でその中のWebで使用されているアーキテクチャに`REST`と言うものがある

# アーキテクチャスタイルとしてのREST

Webのアーキテクチャスタイルは`REST`であり、クライアント/サーバーでもある。

`REST`とは、クライアント/サーバーから派生したアーキテクチャスタイルである。

素のクライアント/サーバーアーキテクチャに様々な制約を加えていくと、`REST`アーキテクチャスタイルになる。

** アーキテクチャスタイルは、特定の実装やアーキテクチャではない。実装から一つ抽象度を上げたのが`アーキテクチャ`, アーキテクチャから一つ抽象度をあげたのが`アーキテクチャスタイル`である。 **


# クライアント/サーバ

WebはHTTPというプロトコルでクライアントとサーバが通信するクライアント/サーバのアーキテクチャスタイルを採用している。クライアントはサーバにリクエストを送り、サーバはそれに対してレスポンスを返す。

## ステートレスサーバ

クライアント/サーバに最初に追加するアーキテクチャスタイルはステートレスサーバである。ここでのステートレストは、クライアントのアプリケーション状態をサーバで管理しないことを意味する。

しかし、昨今ステートレスでないwebサービスはWeb APIが多々存在する。HTTPをステートフルにする代表格はCookieを使ったセッション管理である。RESTの視点から見ると、Cookieを使ったセッション管理は間違ったHTTPの拡張である。

## キャッシュ

キャッシュとは、リソースの鮮度に基づいて、一度取得したリソースをクライアント側で使い回す方式。

キャッシュの利点として、サーバとクライアント間の通信を減らすことでネットワーク帯域の利用や処理時間を短縮し、より効率的に処理できることにある。

## 統一インタフェース

URIで指し示したリソースに対する操作を、統一した限定的なインターフェースで行うアーキテクチャスタイルのこと。

HTTP 1,1ではGETやPOSTなどの8個のメソッドだけが定義されており、通常はこれ以上メソッドが増えない。

インタフェースの柔軟性に制限を加えることで全体のアーキテクチャがとてもシンプルになる

## 階層化システム

サーバとクライアントの間にロードバランサを設置して負荷分散したり、プロキシを設置してアクセスを制限したりする。クライアントからするとサーバもプロキシも同じインタフェースで接続できるので、接続先がサーバからプロキシに変わったことを意識する必要はない。

これは、サーバやプロキシなどの各コンポーネント間のインタフェースをHTTPで統一しているから実現できている。

このようにシステムをいくつかの階層に分離するアーキテクチャスタイルを階層化システムと言う

## コードオンデマンド

プログラムコードをサーバからダウンロードし、クライアント側でそれを実行するアーキテクチャスタイル

利点として、クライアントを後から拡張でき、新しい機能を追加していける

デメリットとして、ネットワーク通信におけるプロトコルの可視性が低下すること

# URI

URIはURIスキーム(http)で始まる。URIスキームは、そのURIが利用するプロトコルを示すのが一般的。

次にホスト名が出現する。ホスト名はDNS(Domain Name System)で名前が解決できるドメイン名かIPアドレスで、インターネット上で必ず一意になる。

ホスト名の後には階層を表すパスが続く。パスは、そのホスト目の中でリソースを一意に指し示す。

# URI設計

- URIにプログラミング言語依存の拡張子を使用しない
- URIに実装依存のパス名を利用しない
- URIプログラミング言語メソッドを利用しない
- URIにセッションIDを含めない
- URIはそのリソースを表現する名詞である

## URI設計テクニック

拡張子で表現を指定する(例: .ja, .en等の言語拡張子)

HTTPにはコンテントネゴシエーションがあり、日本語のOSを使っているユーザーには日本語を、英語OSを使っているユーザーには英語を返せる

# 条件付きメソッド

HTTPメソッドと更新日時などのヘッダを組み合わせることで、メソッドを実行するかどうかを、リソースの更新日時を条件にサーバが選択できるようになる

# べき等性と安全性

べき等とは「ある操作を何回行っても同じのこと」を意味する言葉

GET, HEAD べき等かつ安全
PUT, DELETE べき等だが安全でない
POST べき等でも安全でもない

# ステータスコードの分類と意味

- 1xx 処理中 処理が継続していることを示す。クライアントはそのままリクエストを継続するか、サーバーの指示に従ってプロトコルをアップデートして再送信する
- 2xx 成功 リクエストが成功したことを示す
- 3xx リダイレクト 他のリソースへのリダイレクトを示す。クライアントはこのステータスコードを受け取った時、レスポンスメッセージのLocationヘッダを見て新しいリソースへ接続する
- 4xx クライアントエラー クライアントエラーを示す。原因はクライアントのリクエストにある。エラーを解消しない限り正常な結果が得られないので、同じリクエストをそのまま再送信することはできない。
- 5xx サーバエラー サーバエラーを示す。原因はサーバ側にある。サーバ側の原因が解決すれば同一のリクエストを再送信して正常な結果が得られる可能性がある

# キャッシュ

クライアントはサーバから取得したリソースがキャッシュ可能かを調べ、可能な場合はローカルストレージに蓄積する。

## キャッシュ用ヘッダ

### Pragma キャッシュを抑制する

Pragmaヘッダに指定できる値は、公式にはno-chcheのみになる。この値はリソースをキャッシュしてはならないことを示す。

クライアントは次回このリソースを取得するときに、必ずサーバに再度アクセスしないといけない。

### Expires キャッシュの有効期限を示す

キャッシュの有効期限を示すヘッダになる。

クライアントが次回このリソースにアクセスする時はキャッシュが有効期限内かどうかによって、サーバに再度アクセスするのか、キャッシュを利用するのかを決定する。

リソースを変更する可能性がない場合は永久にキャッシュ可能であることを示したくなるが、そのような場合でもExpiresヘッダには最長で約一年後の日時を入れることを仕様では推奨している


### Cache-Control 詳細なキャッシュ方法を指定する

PragmaヘッダとExpiresヘッダの機能はCache-Controlヘッダで完全に代用できる。

Cache-Controlは現在からの相対期間で有効期限を設定できる

# セマンティクス(意味論)とは

## プログラミング言語における意味論

コンピュータの分野では、プログラミング言語が持つ意味を確定させるための理論のことを「プログラム意味論」と呼ぶ。

## Webにおける意味論

Webにおける意味論は、リソースが持つ意味を確定させるための理論。

HTMLなどで表現したテキストがどのような意味を持つのかをプログラムでも解釈できるようにすると言う目的がある

これによってWeb上のリソースの意味は、人間が読んで解釈するだけでなくプログラムからも処理可能になる。

人間が読んで理解するWebページの意味を、プログラムからも処理できるように、形式的に意味を記述するための技術がセマンティックWebである。

# JSONとは何か

JSON: JavaScript Object Notationの略で、JavaScriptの記法でデータ記述できる点が最大の特徴。

Ajax通信におけるデータフォーマットとして活用される

# メディアタイプ

JSONのメディアタイプは`application/json`である

# データ型

JSONに組み込みで用意されているデータ型には次の6つがある

- オブジェクト
- 配列
- 文字列
- 数値
- ブーリアン
- null

# リソース設計とは

クライアントとサーバ間のインタフェースの設計、WebサービスやWebAPIの外部設計のことを指す。

どのようにリソースを分割し、URIで名前を付け、相互にリンクを持たせるかが設計の勘所になる。

設計とは、システムをどのような構成でどのように開発するのかを検討し、図や文書に残す作業のこと。

そのうえでリソースの設計図とはリソースの種類、リソースの表現、リソースの操作方法、リソースとリソースのリンク関係などを指す。

# トランザクション

たとえば銀行口座で五万円を振り込む処理では、振り込み先の口座の残高を五万円減らし、振込先の口座の残高を五万円増やす処理が必要になる。このとき、どちらか片方が成功し、もう一方が失敗してしまうと五万円を得したり、損したりする人が出てくる。

このようなことが起こらないように、二つとも処理が成功するか、失敗した場合は二つとも元の状態に戻すことを保証することがトランザクションである。

