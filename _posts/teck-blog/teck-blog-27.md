---
title: システム運用アンチパターン を読んだ
slug: teck-blog-27
tags: ["読書メモ"]
image: study.png
description: 『システム運用アンチパターン』現場で感じた課題や改善点をまとめました
created_at: 2025-10-05T15:22:00
---

# はじめに

『システム運用アンチパターン』を読みながら、現職での運用経験と重ねて考えた内容を整理しました。  
特に第1章と第2章は「文化」や「権限構造」など、人に関わるテーマが中心で非常に示唆的でした。

---

# 第1章：DevOpsにおける「人」と「文化」

DevOpsは **「人・プロセス・ツール」** の3要素から構成されますが、本書ではその中でも「人」が最も重要であると強調されています。

> 自動テストを価値あるものと考える文化がなければ、ツールは価値を提供しません。DevOpsはまず人、次にプロセス、そしてその次にようやくツールについて考えるのです。

この指摘には非常に共感しました。  
現職でも、ツール導入だけでは運用が改善しない例を多く見てきました。

---

私のチームでは、Cloud Logging, Sentry などの監視ツールを導入しています。  
しかし、実際の運用では Cloud Logging でエラー検知 → 人が調査 → 対応 という運用に留まっており Sentry を十分に活用しているとは言えません。

## このような状況を生み出している要因の一つは「ツールを駆使して運用を改善していこう」という文化や意識がまだ十分に形成されていない点にあると感じています。

本書では、DevOpsを支える4つの柱として次の項目が挙げられています。

- **文化 (Culture)**
- **自動化 (Automation)**
- **メトリクス (Measurement)**
- **共有 (Sharing)**

私の職場では、データ不整合による想定外エラーのリカバリフローなどは整備されており、「文化」と「自動化」に関してはある程度定着していると感じました。

一方で「メトリクス」については、次の一文が特に印象に残りました。

> エラーが発生していないことを確認するだけでは不十分です。システムを評価する方法を強化するものとしてメトリクスは使われるべきです。

現場では、想定外のエラーが発見された場合、該当箇所にパッチをあててPRをリリースし、解決して終わりというケースが多いです。

「なぜそのエラーが起きたのか」や「プロセス全体をどう改善できるか」といった振り返り後の仕組み整備について考え検討することは不足していると感じています。
全体を俯瞰して改善提案をしてくれるメンバーもいますが、まだ少数派です。そのため改善を継続するチーム文化の形成をしていくことが大事なのかと思いました。

# 第2章：パターナリスト症候群

第2章では、「パターナリスト症候群」という構造的な問題が紹介されています。

特定のグループが他のグループより強い権限を持ち、他のグループが何かを行う際に必ず承認を得なければならない状態。いわば「親子関係」のような組織構造。
最初のうちは秩序を保つ仕組みとして有効に見えるものの、やがて生産性低下やチャレンジの阻害につながると指摘されています。

システム運用の現場では、SQLを使ってデータを直接修正する場面もあります。その際、「SQLを書く人」と「承認する人」が分かれているというルールがあります。
安全性を保つためには有効な仕組みですが、「書く人は子、承認する人は親」という構造になりがちで、これも小さな形のパターナリスト症候群なのではないかと感じました。

このようなパターナリスト症候群への解決方法として、自動化によるゲートキーパーの排除が提案されていました。
承認プロセスにおける、Issue承認者が気にしている箇所をカバーできるように、スクリプトを組んで自動化しようというアプローチです。

現職の例で考えると、現職では生成AIが導入されているため、ある程度ルーティンワークとなっているような内容については生成AI等でルールに則ってIssue作成を自動化してしまうのが良いと思いました。
監査の観点等である程度ログを残す必要があるため、作業者と承認者を立てる必要がありました。
変更手順作成から作業者・承認者をの設定を自動化して、そこからは本来の変更作業を行うようにすれば、既存の文化を大きく変更することなく組織に定着してくれるのではないかと思いました。
今は devin みたいな slack ともコラボレーションできるようなツールもあるため、より柔軟な自動化が実現できそうです。

# 第3章：盲目状態での運用

アプリケーションの運用状態を可視化するためのカスタムメトリクスについてと運用している中で価値あるログ出力について記載されていました。

システムの動作を理解するための指標として以下の三つを意識すると良いとありました。

- スループット
- エラー率
- レイテンシー

現職でもGCPの機能を利用して上記の数字を閲覧できる状態となっていましたし、唐突にエラーログが頻発した時は上記の指標を参考に問題解決に取り組んでいました。
運用していてよくあったのが、タスクキューに詰んだタスクで処理に時間がかかり、キューにタスクが積みきれずサーバー側から例外が発生するという問題です。タスクキューにタスクが溜まりすぎて捌ききれないという問題を特定するに至ったのは、上記3つの指標を見たときに明らかとなった覚えがあります。

価値あるログとログ集約について。
以下のポイントを押さえられていると価値のあるログと言えるそうです。

- 様々なシステムからのログを1つのログ集約システムに集約する
- 特定のPKやシステムの状態メッセージなど、ログの文脈を適切に示す
- 適切なログレベルの設定
  - 現職では、本来エラーレベルで設定する必要がないログをエラーに設定していたのが原因で、追う必要のないエラーがたくさん検出されてしまう問題が発生したことがありました。
- エラーメッセージの改善
  - 期待される結果と得た結果、取るべき修正手段を示すと良いとあります。現職では、なぜそのエラーが発生したかしか示していませんでした

# 第4章：情報ではなくデータ

目的に応じたダッシュボードの作成について記載されていました。
既に作成されたダッシュボードを閲覧していたこともあり、あまり解像度が上がらなかったため流し読みしました。

# 第5章：最後の味付けとしての品質

継続的にデリバリを可能とする状態を作るための自動テストについて取り上げられていました。機能フラグという機能の提供とデプロイを分離する手段についても取り上げられていました。
現職においても自動テストを書いて9割以上のカバレッジを満たすように開発をしていた、かつ機能フラグに相当する手段を用いて継続的にデリバリしていたため、流し読みしました。

# 第6章：アラート疲れ

運用者が多くのアラートに頻繁に晒されることで、アラート疲れが発生してしまう。
アラート疲れが発生してくるとアラートに鈍感になり、アラートシステム全体の有効性が低下してしまうおそれがあるとのことでした。

特に常に似たようなアラートに晒されることで、そのアラートの発生が当たり前になってきて鈍感になってくる事態については非常に共感しました。
いつものようにスルーしていたら、実はユーザー影響のあるエラーで関連部署へのエスカレーションが遅れたという事態は実際に経験しました。

こちらの章については、システム運用部門とエンジニアが分離しているが故の課題が挙げられているような気がしました。現職では開発チームが運用も行っているため参考程度に読みました。

# 第7章：空の道具箱

自動化を進めるための仕組み化について記載されていました。
タスクの複雑度や頻度に応じてかかる時間を算出し、タスク毎にどれくらいのコストが出るのかを明示的にすることが大事とありました。
その通りだと思いましたが、結局ビジネスを優先したい組織であればあるほど難しそうだよなあと思いました。今はAIとかもあるので、割と簡単に短時間で自動化できそうな気がしますが。。。

# 第8章：業務時間外のデプロイ

デプロイ戦略のアンチパターンへの改善策について説明されていました。

まずアンチパターンとして、以下三つが挙げられていました。

- 恐怖心と抵抗感
- リリースの詰め込み
- 重厚な変更管理プロセス

それへの解決策として、以下が挙げられていました。

- デプロイをより頻繁に行う
- 変更の最小化
- デプロイプロセスの自動化
- 自動テストの強化

現職では、特定のブランチにマージされるたびに、テストが走り、デプロイプロセスが自動的に実行される仕組みが整備されています。
機能がリリースされている特別な本番環境で動作確認を行い、問題がなければ、ユーザーが触っている環境に反映する仕組みが整備されていました。

また、リリースはPR単位で行われていて、頻繁に行われていましたため、ベストプラクティスに近い形でデプロイの仕組みが整備されていると感じました。

# 第9章：せっかくのインシデントを無駄にする

予期せぬ出来事によりシステムに悪影響を与えることをインシデントと呼び、インシデントから学ぶことの重要性について説明されていました。
本書では、インシデント発生後24時間以内にポストモーテムを作成することを推奨していました。
インシデント中に、何が、誰によって、いつ行われたかという事実のみを記録したタイムラインを作成し、なぜ、その決定がなされたのかという背景情報を後から追加していく形でポストモーテムを作成する方法が紹介されていました。

現職においてもインシデント発生後には、なるべく早い段階でポストモーテムを作成するようにしていました。
発生原因から、その後の対応まで資料にまとめ、パブリックな場所に共有され、誰でも閲覧できるようになっていました。

# 第10章：情報の溜め込み

特定の個人に知識が集中し、組織全体での知識の共有が妨げられる問題について説明されていました。
ドキュメントやランチでの会話を通して共有しようねっていうことが書いてありましたので、その通りと思いつつ流し読みしました。

# 第11章：命じられた文化

チームや組織の文化的価値観や習慣等の組織に根付く文化についての説明がありました。
既存の習慣の目的を知り、言葉を使って新しく文化を変えていくことができ、より自動化する習慣や自動化等の開発タスク以外への意識についても変革していくことが可能だと説明されていました。

まあそうだよなあーと思いながら読んでいました。

本章の中でも人材の採用についても触れられており、結構参考になりました。
以下のようなポイントの回答を引き出すようにすると良いとされていました。

- 組織の価値観との適合性
- チームの価値観との適合性
- 技術力

現職のチームの価値観であれば以下のような点が考えられそうです。以下の点を面接で引き出せるように質問を組み立てると良いとありました。

- チームやCSチームとの協力して開発・運用
- 品質維持・向上のためのコードレビュー
- 自ら手を挙げ行動する姿勢

また、その候補者の情熱を測る質問と技術力を測る質問を組み立て、総合的な評価を複数人で検討するのが良いとありました。自分も過去に面接官をやっていて非常に難しさを感じていたため、もっと早く読みたいなあと思いました。

# 第12章：多すぎる尺度

組織やチームでやるべきタスクの優先度付の考え方について記載されていました。
タスクの緊急度と重要度の2軸で考え、緊急かつ重要なタスクから取り組むべきと説明されていました。

こちらの章についてもそうだよなーと思いながら流し読みをしました。

# まとめ

現職ではDevOps的な働き方をしているため、こういった体系的な参考書を読んだことがなかったため、非常に勉強になりました。
特に自動化の推進は、今からでも行動できるし費用対効果も大きいそうなところから推進していこうかと思いました。

また、ログレベルの修正やエラーメッセージなども今日からのリファクタリングとして取り組んでいこうと思いました。
